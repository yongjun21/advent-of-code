function summarize(input, withSmudge = false) {
  let sum = 0;
  input.forEach(pattern => {
    const rows = pattern.length;
    const cols = pattern[0].length;
    const encodedRows = new Uint32Array(rows);
    for (let j = 0; j < rows; j++) {
      let bitValue = 1;
      for (let i = 0; i < cols; i++) {
        if (pattern[j][i] === '#') {
          encodedRows[j] += bitValue;
        }
        bitValue *= 2
      }
    }
    const encodedCols = new Uint32Array(cols);
    for (let i = 0; i < cols; i++) {
      let bitValue = 1;
      for (let j = 0; j < rows; j++) {
        if (pattern[j][i] === '#') {
          encodedCols[i] += bitValue;
        }
        bitValue *= 2
      }
    }

    for (let k = 1; k < rows; k++) {
      let mismatch = 0;
      let oneBitDiff = 0;
      if (k <= rows / 2) {
        for (let kk = 0; kk < k; kk++) {
          const diff = encodedRows[kk] - encodedRows[2 * k - 1 - kk];
          if (diff) mismatch++;
          if (isOneBitDiff(diff)) oneBitDiff++;
        }
      } else {
        for (let kk = rows - 1; kk >= k; kk--) {
          const diff = encodedRows[kk] - encodedRows[2 * k - 1 - kk];
          if (diff) mismatch++;
          if (isOneBitDiff(diff)) oneBitDiff++;
        }
      }
      if (withSmudge) {
        if (mismatch === 1 && oneBitDiff === 1) {
          sum += 100 * k;
          break;
        }
      } else if (!mismatch) {
        sum += 100 * k;
        break;
      }
    }
    for (let k = 1; k < cols; k++) {
      let mismatch = 0;
      let oneBitDiff = 0;
      if (k <= cols / 2) {
        for (let kk = 0; kk < k; kk++) {
          const diff = encodedCols[kk] - encodedCols[2 * k - 1 - kk];
          if (diff) mismatch++;
          if (isOneBitDiff(diff)) oneBitDiff++;
        }
      } else {
        for (let kk = cols - 1; kk >= k; kk--) {
          const diff = encodedCols[kk] - encodedCols[2 * k - 1 - kk];
          if (diff) mismatch++;
          if (isOneBitDiff(diff)) oneBitDiff++;
        }
      }
      if (withSmudge) {
        if (mismatch === 1 && oneBitDiff === 1) {
          sum += k;
          break;
        }
      } else if (!mismatch) {
        sum += k;
        break;
      }
    }
  });
  return sum;
}

function isOneBitDiff(diff) {
  if (!diff) return false;
  const log2Diff = Math.log2(Math.abs(diff));
  return Math.ceil(log2Diff) === Math.floor(log2Diff)
}

const test = `
##...######...##.
......#..#.......
##.##########.###
###..........###.
...#..#..#..#...#
##..###..###..###
..##.#.##.#.##..#
..####.##.####..#
####........####.
..#.##.##.##.#..#
##.###.##.###.###
###.#......#.####
......####......#
#..#.##..##.#..##
..#.########.#...
##...######...##.
..#.##....##.#..#

...##......#.
...#.......#.
#......##.###
.##########.#
#####.###.##.
###.####.##..
###.####.##..
#####.###.##.
.##########.#

#.##..#
##.#.#.
##.#.##
#.##..#
...####
#.#..#.
#.#..#.

.##.#..
.##.###
..#####
#..####
.####..
.#...##
##...##

#.#.....#.##.##.#
#.#.....#.##.##.#
.....#...#####...
...#.###....#...#
.###..####.#..#.#
#.###.#.#..###..#
..####...##.#.##.
..####...##.#.##.
#.#.#.#.#..###..#
.###..####.#..#.#
...#.###....#...#
.....#...#####...
#.#.....#.##.##.#

###.####.#..#
#...##.##..#.
.#.##.#.###.#
.#..#.#.###.#
#.#...##.#.##
##.#..##.#..#
##.#...#.#..#
#.#...##.#.##
.#..#.#.###.#
.#.##.#.###.#
#...##.##..#.
###.####.#..#
#..#..#..#.##
.#...#.#..#.#
.#...#.#..#.#
#..#..#..#.##
###.####.#..#

.#.#..#..
..#.##.#.
..#.##.#.
##.#..#..
.#.#.#.##
...#...##
...#...##

.#......#..##.###
.###..###.##.####
.##....##.#####.#
#.######.##...##.
##.#..#.##.###..#
#...##...#.#.###.
..##..##.........
#..####.###....#.
.#.####.#.#####..
.##....##.##..##.
###.##.####....##
#..#..#..#..##...
#..####..#####...
#..####..#####...
#..#..#..#..##...

...#....#
###.####.
###....#.
.#..####.
..##.##.#
#####..##
#..######
#####..##
.###.##.#
..##....#
..##....#
..##....#
..##....#
.###.##.#
#####..##

#.##...##.#
##..#####..
##..##.#.#.
.####......
#.##.###...
..##....###
##..####...
##..####...
..##....###
#.##.###...
.####......
##..##.#.#.
##..#####..

..###...#
..###...#
.#..##.##
.###....#
...####.#
..###.#.#
#.#..#.#.
#.#..#.#.
..###.###
...####.#
.###....#
.#..##.##
..###...#

...#..#.###....
#.#....#..#....
..##......##.#.
##.#.####.#.###
##..##.#..###.#
#######...##..#
..#.#...###.#..
..#####..######
###.##..#..####
##.######..#...
##.######..#...
###.##..#..####
..#####..######
..#.#...###.#..
#######...##..#

#.##.##
#.##.##
..###.#
..###.#
..####.
......#
.....#.
.#..##.
.#..##.
.....#.
......#
..####.
..###.#
..###.#
#.#####

##..#..#.
..###..##
###.###..
###......
....#..#.
...#.##.#
.....##..
##...##..
##.#....#

.#..#.##..##.#..#
#.#...##..##...#.
#.#...##..##...#.
.#..#.##..##.#..#
.###....##....###
###..#..##..#..##
#.#...######...#.
...##...##..###..
#...#.######.#...

..#..#....#.###
#.####....#..##
###..###..#....
.#.##.#....##..
#......#...##..
.#.##.#..###.##
..#..#..#.#.#..
.######.#.#..##
###..####..####
##.##.###......
...##...###....

###..###..#####..
.#...#.....##....
.##............#.
####...#.####....
#....#.#.##.#..#.
##....#.#.#..#..#
#.#.###..#..#..##
#.#.###.##..#..##
##....#.#.#..#..#
##....#.#.#..#..#
#.#.###.##..#..##
#.#.###..#..#..##
##....#.#.#..#..#

##..#..#.#.##.#
##.#.#.#...####
####..##...#.#.
..##.#....#.#..
..##.#....#.#..
###...##...#.#.
##.#.#.#...####
##..#..#.#.##.#
#######.###...#

....#.##..#..#.
#..###.....##..
#..#.###.##..##
#######.##.##.#
.##..#....####.
....##..#......
####..#.#.#..#.
..#.####.##..##
.##...##.#.##.#
....#..#.##..##
.....#..#.####.
.##..##....##..
....#.##...##..

##....#....##
.....###.####
.####....##.#
.####....##.#
.....###.####
##....#....##
.....#.###...
###.#.#...###
###.#.#...###
.....#.###...
##....#.....#

############.##
#..######..#.##
#...####...####
...######......
#.###..###.#.##
#..##..##..####
.###....###.###
#.#......#.#.##
..########..##.

......#
####.##
.##.#..
#..###.
....##.
###.#..
#####..
#####..
###.#..
....##.
#..###.
.##.#..
####.##
......#
....#.#
....###
....#.#

.#.##.###.#..
.#...#.#...##
.##..#####...
.##..#####...
.#...#.#...##
##.##.###.#..
.##.##..#.###
###..#.#...##
.#.##....##..
##..##..###..
##..##.#.#.##
...#.#..#####
.##.#.#.###..
..##..#.#.###
..#.##....#..
#.#####.#..##
.####..###...

..#.##.##########
.##..#.#...#....#
..#.##...###....#
...#.#..#..##..##
.#..#........##..
.#..#........##..
#..#.#..#..##..##
..#.##...###....#
.##..#.#...#....#
..#.##.##########
#.#.####..#.####.
.##.###..##......
###.#..###.######

.##..#.#..#.#.#
.##..#.#..#.#.#
#.#.#.##..#.#..
#..#....##.##..
#.....##.#.#.#.
#..#.....#.###.
..##.##..#####.
###..#..#.###.#
..##...#.......
.#...###.#.##.#
.##..###.#.##.#
..##...#.......
###..#..#.###.#
..##.##..#####.
#..#.....#.###.

.########
....####.
####...##
####....#
#..#.##.#
##.##..##
##.##..##

#........##
.##.##.##..
...####....
##.####.###
###.##.####
#..#..#..##
.#......#..
..#.##.#...
.##.##.##..
.#####.##..
..######...
.#.#..#.#..
.##....##..
.##.##.##..
..#....#...

#########.#######
.#.##....##.#..#.
##.##.##.##.####.
.##.##..##.##..##
.#.########.#..#.
....##..##.......
..#........#....#
#.#.#.##.#.#.##.#
.###.####.###..##
##...#..#...####.
.#....##....#..#.
.#.#.####.#.#..#.
#..########..##..
####.#..#.#######
####.#..#.#######
...#.#..#.#......
..###.##.###....#

.#.####.....#####
.###.##.#.#...###
#.#.#######.#####
#..#...###..#....
#.#.##.#.#.####..
.#.#..#.#..#..#..
##.#..#.#..#..#..

.........##.#.#
..#######....##
.###...####..#.
....#.#.#.##...
.###.#.#....#.#
#.##...##...##.
.##...#.#.....#
.##...#.#.....#
#.##...##...##.
.###.#.#....#.#
....#.#.#.##...
.###...####....
..#######....##
.........##.#.#
.........##.#.#

....##...
......###
#..##..##
.##.#.#..
#..##....
.##.#...#
#######.#
#..#.##.#
#..####.#

##.####.#######
...####...#.##.
#.#.##.#.###..#
..######..#####
....##....#....
....##......##.
.#..##..#.###.#
#...##...#.....
##..##..#######
.##.##.##..#..#
#..####..#.....
...#..#....#..#
#.##..##.#.####

##.#.##
...####
####...
..#..##
...##..
###.#.#
.....##
##.####
..#....

.###.##.#...#..
.#.....#..###.#
.#.....#..###.#
.###..#.#...#..
.###.####..##..
.###.#....#.##.
#.#..##.......#
##..#.##.#...#.
...#..#....#...
##...##...#.##.
##...##...#.##.
...#..#....#...
##..#.##.#...#.
#.#..##.......#
.###.#....#.##.

#...#....##..
......###..##
.##..#...##..
####.##......
..##.##......
##.....######
..#.#..######
.#.#.#.######
.#..###.####.
#............
.####....##..
.##.#####..##
.##.###..##..
###..#.######
#...#.#######
..#.#........
##...##......

##.#.....
..#..#.#.
....#.#.#
....#..#.
....#..#.
....#.#.#
..#..#.#.
##.#.....
.####....
#######..
###.###..
.####....
##.#.....

#.###.###
.##.#..#.
#.#.####.
.#.######
#...#..#.
#.##....#
.#...##..
#.#.####.
###.#..#.
...#....#
#.#######
#.#######
...#....#
###.#..#.
#.#.####.
.#...##..
#.##....#

....##.
#..#..#
.##....
####..#
#..####
....##.
#......

#..##..#.
.##..##..
#..##..##
........#
.##..##..
########.
........#
###..####
#..##..#.
#..##..##
.##..##.#
.##..##..
#..##..#.

#...#.#..#.#.
####.......##
..###.#..#.##
.######..####
#######..####
....###..###.
#.##...##...#
.###...##...#
.##.##....##.
......#..#...
#.#..........
#.#.##.##.##.
#.#.##.##.##.
#.#..........
......#..#...
.##.##....##.
.###...##...#

.##....#....#
#####.##....#
.#.....#....#
##..#####..##
...###.##..##
#.#.####....#
###..........
####.#..####.
##.##.#......
...##########
......###..##
###.#.###..##
#.###...#..#.
#####...#..#.
###.#.###..##

####.#.#..#.#
#####..#..#..
#..###..##..#
####.########
.....########
####..######.
.##..##....##
.##.#........
.##.#..####..
.##....####..
#..#..#.##.#.
....##.####.#
######..##..#
#####..#..#..
##.###.####.#
#..##.######.
....#########

...#.....##
####..#.###
#########..
...##.....#
..#..#.....
......#.##.
##.#.......
###...##.##
....#####..
....#####..
###...##..#
##.#.......
......#.##.

##..###
..##...
#.##.##
..##...
#.##.##
.#..#..
#.##.##
#.##.#.
#....##
##..###
.#..#..

....##.##.##.
..#.###..###.
#.#.##....##.
##..#.####.##
#...#.#..#.#.
###..#....#..
#####.####.##
..#..######..
#...########.
#...########.
..#..######..
#####.####.##
###..#....#..

##....##..#
###..######
.#....#....
###..######
#.####.####
#......####
.######....
###..######
..####..##.
.######....
...#....##.
##.##.#####
..#..#.....

##..#.#####..##.#
.#..###........##
.#...#.###..#.#.#
.#...#.###..#.#.#
.#..###........##
##..#.##.##..##.#
.#.#..##.##....#.
####.####.#.##..#
.#####...###..#..
.###...##.#####..
#..##.#....####..
#.#.#.###..#.#.##
##..#..####..#.##
..#..##..#####.#.
..#.#.#..#.###..#
..#.#.#..#.###..#
..#..##..#####.#.

..#...########.
##.#..###..###.
...##..#.##.#..
.#...#..####..#
######...##...#
...#..#.####.#.
......##....##.

..#..#.
...####
...####
..#..#.
..#...#
####...
#..#...
##....#
#.#...#
####.##
..##.##
.#.#..#
...#.#.
#.####.
#.#.##.

.##...###
.##...###
#.##.##..
##.#..###
#####....
.#.......
#.#.#....
##.##.###
..###..#.
##.##.#..
##..#.#..
..###..#.
##.##.###
#.#.#....
.#.......
#####....
##.#..###

.#..###.#.#.##..#
###.#.#.#.#.#....
....#..##.#..####
#.....#...#.##..#
#..##..###.##....
..#.#.##.###.....
##.#....#.#######
...###.#.#.######
####.##....#..##.
..####.....#.###.
#####..###.#.####
...##....#.######
#...##....#.#.##.
##.#...##.#.#####
.##.##.#.###.....
.########..##....
.########..##....

....#.##...##
##.....#.#...
..##..##..#..
##.#.##....##
..##.....#.##
.#..#.##.#...
.#...#.######
.#...#.######
.#..#.##.#...
..##.....#.##
##.#.##....##
..##..##..#..
##....##.#...

.#..#...#.#...#
..##..#..##.###
.#..#.##.#.#...
..##..##.#.###.
#....###.....##
#....###.....##
..##..##.#.###.
.#..#..#.#.#...
..##..#..##.###
.#..#...#.#...#
##..##...####.#
.#..#..###.##..
#....##.#..##.#
#.##.######....
..##..#..#.####

.#.#.##...####...
.#.#.###...######
####..#.#........
####..#.#.....#..
.#.#.###...######
.#.#.##...####...
######.#......##.
##.#...#.....#.#.
#.#.#.#.#.#.#.#.#
#..####.###...###
..#.###.#.##.#..#
...####.#.#.#..##
...####.#.#.#..##

....#.#.#.##..#
##...#..#..#.##
####.##..##..##
#.###.#.##.#.#.
..#.##.#...####
..#.##.#...####
#.###.#.##...#.
#.#..#..###...#
#.#..#..###...#
#.###.#.##...#.
..#.##.#...####
..#.##.#...####
#.###.#.##.#.#.

##....##...
#..##..#.#.
#..##..###.
##....##...
.##..##..##
.#.##.#.#.#
..#..#..##.
##....##...
..#..#.....

..###.#...##.####
.##....#...#..##.
.#####...########
.#####...########
.##....#...#..##.
..###.#...##.####
#.#.##.#.##.##..#
.#....##...##....
....##..#.#.##..#
..####.#.###.#..#
.#####....##.....
..#..#...........
#.####..........#

#.#..#.##
.#.##.#..
##....###
.##..##..
...##....
...##....
.##..##..
##....###
.#.##.#..
#.#..#.#.
##....##.
..####...
.#....#.#

....##...##..
.##.#..#.#.##
#..##....###.
#..##....###.
.##.#..###.##
....##...##..
#..#.##.#.##.
.##.###..##.#
#######.##...
#####..####..
#..###.....#.

#.####.....
.###...#..#
###...##..#
#.##..#####
#.##..#####
###...##..#
.###...#..#
#.####.....
..#..##.##.
...#.######
.....#.####
#.##.##.##.
#####.##.##

#######.##...####
#######.##...####
.#....##....###..
.......#...#..#..
.###...#.#######.
#.#######.#####..
.##.#.###...#..##
...#..####..##...
..#.##.#.##..#..#
..#.##.#.##..#..#
...#..##.#..##...
.##.#.###...#..##
#.#######.#####..
.###...#.#######.
.......#...#..#..
.#....##....###..
#######.##...####

##..#.#...#
...########
...#.##....
####.###..#
...#.#..##.
....##.....
...##...##.
##...#..##.
...##...##.
###.#..####
..###.##..#
....####..#
..##...####
..#.#.#....
##..#.##..#
..###.#####
####..#....

..###.##..#....##
...##.#.#..#...#.
##..##....###.#.#
##..##....###.#.#
...##.#.#..##..#.
..###.##..#....##
##....###..####..
###...####.....##
#####..###...##..
..#..#.###...#...
....####.##..#.##

...#....##....#
...##.#....#.##
#.#.##..##..#..
.######.##.####
.##.###....###.
#..###.#..#.###
#.###.######.##
.##..###..###..
.##..###..###..
#.###.######.##
#..###.#..#.###

###.###
##..#..
###.#..
###.#..
##...##
..##...
##.##..
###.#..
..#####
##.##.#
..#####
..#....
##..###

#..#.#.#..#.#
.##.#.##..##.
#####..#..#..
#..###.#..#.#
####..##..##.
......#.##.#.
#..##...##...
.##....####..
#..####....##
..#..#......#
#..#.#.####.#

.......#.##
##..##.#..#
##..##.###.
..##..#....
.#..#.#..##
......#.#..
........#..
########.##
......#..##
######..###
########..#
......##.#.
##########.

.#.#.####.#.#..
##...####...##.
..#.######.#..#
####.#..#.#####
####......####.
##..#.##.#..###
##..##..##..###
....#....#....#
###.######.###.
..............#
##.########.##.

.#..#..
...###.
...###.
.#..#..
.##....
##..###
...#.##
..#.#..
..#...#
#.##..#
#.#...#

...#...
#..##..
...##..
.#.##..
.#.##..
...##..
#..##..
#..#...
#.#####
#...#..
#.#.#..
#.#....
....#..
....###
..###..
.#..#..
..#..##

...#...###.....
.#.##...#.##.##
#.#.###....#.##
..#.##...#.##..
#.####.###...##
...##.#.#.##...
####..##.#..###
.##.#...#..####
.#....###.##...
#.#....##..####
##.###..#####..
.#......##.#.##
##...###.......
#..#..#.#.#..##
#..#..#.#.#..##
##...###...#...
.#......##.#.##

.##..##
####.##
.##.#..
#####..
#####.#
.##.###
#..####
#..#...
####.##
#..#.##
....#..

####.#..#..#####.
#...#......#.#.##
#...#....#.#.#.##
####.#..#..#####.
##..#...#...#....
#..#...#.#...###.
....#...#####.#.#
#...##..###...#.#
.#.#.####.###.#..
#.....##..#.##.##
##..#####..#.#.#.
##..#####..#.#.#.
#.....##..#.##.##

#....##..##..#.
..##...###.#...
..##...###.#...
#....##..##..#.
.#..#.#####.##.
#.##.##...#.#.#
#.##.##...###..
#....#....#.#..
#.........#...#

#####..####..##
#..##.#....#.##
#..##.#####..##
.##..##....##..
....#..#..#..#.
#..#..######..#
.##.#.##..##.#.
....#........#.
#####........##

##....#####.##.
.#.##.#.##..##.
.######.....##.
........##.#..#
###..######.##.
..#..#...#.....
........##.####
#......#.##....
##....##..#.##.
.#.##.#..#..##.
..####....#####
#..#...#..#####
.##..##..#.#..#
#......#.##.##.
#..##..#..##..#

...####..#.#.####
..#..#.####.##..#
.....###.###..##.
.....#######..##.
..#..#.####.##..#
...####..#.#.####
.#.###..##.#.#..#
#.##.######..#..#
.#..#.##..#.##..#
.#.#....###.#.##.
.#..###..#.##.##.
..##..###...#####
##...#...#.......
#..#.###..#..####
##..#...#....####

.##.#........##..
#####.#.#....#.##
#####.#.#....#.##
.##.#.#......##..
...###.#####...#.
####.######.#.#.#
..#.#.#...#.#.###
##.#.###...#.#.#.
##.#.###...#.#.#.

..##.###.
.##..##.#
###.#.#..
##..#.#.#
#.#.##.##
#.#..#.##
##..#.#.#
###.#.#..
.##..##.#
..##.###.
..##.###.

#.#.#..#.#.#....#
#.########.#.##.#
####....####.##.#
#....##....######
...######...####.
#.##.##.##.###.##
.#.######.#..##..
#####..######..##
....####....####.

##.#..#.###
..##..##...
##.#..#.###
....##.....
#.#....#.##
.###..###..
#.#....#.##
#.##..##.##
#.######.##
.#......#..
###....####
.###..###..
#.#.##.#.##
#.#....#.##
.####.###..

.#..#..###...##
..##.....#.#...
.####.####.....
.#..#.#.##.##..
######.###.####
#.##.#..#.....#
######.#..##.#.
######.#..##.#.
#.##.#..#.....#
######.###.####
.#..#.#.##.##..
.####.#.##.....
..##.....#.#...

##..##...####..
.####..###..###
#....##.##..##.
#.##.##.#.##.#.
......#.######.
#.##.###.#..#.#
..##..####..###
#....#.#.#..#..
........#....#.
......###....##
.......##.##.##
#.##.#..#.##.#.
..##...##.##.##
#.##.###......#
.......########
.####.##..##..#
.####.#.##..##.

#..####..#.###.
##......##.#..#
###.##.###...##
#.#....#.#.##.#
#.#....#.#.##.#
###.##.###...##
##......##.#..#
#..####..#.###.
##..##..###..##
##########.#...
.##....##.##...
.#.#..#.#.##.#.
#.#...##.##.#.#
.##.##.##.##.##
#############.#

##.#..#######.###
#....##..#..#.#.#
#...###..#..#.#.#
##.#..#######.###
##.#...#.##...###
##.#...#.##...###
##.#..#######.###
#...###..#..#.#.#
#....##..#..#.#.#
##.#..#######.###
#..#......###...#
.#..###..#.......
......#..##.##...
.#.#...##.#..####
..#..##..#.#.###.

.###..##.##
.###..##.##
##...#....#
.#.##.#..##
#...#.##...
##.#...####
####.#.##..

..#...#..#...
##....####...
##..#.#..#.#.
##.####..####
###..##..##..
..##.#....#.#
##...........
....#.####.#.
..##.##..##.#
####..#..#..#
.....######..
..##.#.##.#.#
..#.#..##....

..#..#...
###....##
##.##...#
##..#.#..
##.#...#.
##..#..#.
..#####.#
..##..##.
########.
#######..
..##..##.
..#####.#
##..#..#.

####..###.##.#.
####..###.##...
.##..####.####.
#..##...##.###.
.##..###.......
#..#.##..#.#...
#..#####.##.#.#
.##....#..#.#.#
.##.#####.##.#.
.##..#...###..#
#..##..#.#...#.
#..#.##....#...
#####...####..#

#..##....##..####
#....####....#..#
#..#.####.#..####
###.##..##.###..#
#.#.#.##.#.#.#..#
##..#.##.#..#####
...##.##.##...##.
#..#..##.##..####
#.#.#.##.#.#.#..#
.##.#....#.##.##.
...#.#..#.#...##.
..##..##..##..##.
..##......##.....

.....#..##..#
##...########
.#.#....##...
#.#.#........
.#...########
...##########
######..##..#

.#..#..#.
.#..#..#.
##..#####
#.##.##..
.#..#.###
##...#.#.
#....#.##

...#.##.#
..######.
##...#..#
##...##.#
..######.
...#.##.#
###.#..#.
###..#...
###.#.##.
...###.##
..##.#..#

#.#########
#..........
####.####.#
###.##..##.
.###.#..#.#
##...#####.
....#....#.
.#.#..##..#
.#.#..##..#

#########.#..
##.##.###.#..
##....##...##
###..####....
.#.##.#.###.#
##.##.####.##
.#.##.#.#..##
.##..##.#.#..
#.#..#.#..###
#.#..#.######
..####..#..##
##.##.####...
##....#######
###..#####...
.#.##.#.#.###
.#.##.#.##.##
##....##.....

#####.#...#
.##...####.
.###...##.#
.....#.....
.....#..#..
##..#..#..#
..###..##..
#####.####.
##...#..##.
..#.#.....#
..#.#.....#
##...#..##.
#####.####.
..###..##..
##..#..#..#
.....#..#..
.....#.....

.##.....####..#
.....#........#
#..#.####..####
####...#.##.#..
####.#.######.#
....##...##...#
####.#.#.##.#.#
......#.#..#.#.
#..####......##
####...######..
#..####..##..##
#..##.#.####.#.
......##.##.##.

##.########
##.########
.#..##.##.#
##.#.######
....##.##.#
#.###..##..
..##...##..
..#####..##
#.#.#######
..##.#.##.#
....#......
.#####....#
#.#.#..##..
.#.##.#..#.
#.#....##..
.#.####...#
#..##......

.#....#.#####.#.#
#.#...##..###.###
#.##.#..##..##..#
.....#.###.#...##
.##..#....###.#..
.#..#...#..#.#.#.
.#..#.#..#.##.###
.#..#.#..#.##.###
.#..#...#..#.#...
.##..#....###.#..
.....#.###.#...##
#.##.#..##..##..#
#.#...##..###.###
.#....#.#####.#.#
.#....#.#####.#.#

##..##...
###.##...
#.###..#.
#.###..#.
###.##...
##..##...
#....#...
#####..#.
##..#####
#.##..#.#
.###.#.#.
###.###.#
...###...
`.trim().split('\n\n').map(block => block.split('\n'));

console.log(summarize(test));
console.log(summarize(test, true));
